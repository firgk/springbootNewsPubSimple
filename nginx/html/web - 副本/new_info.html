<html>
	<meta charset="UTF-8">
	<head>
		
		<link rel="stylesheet" href="currency.css">
		<script src="https://apps.bdimg.com/libs/jquery/2.1.4/jquery.min.js"></script>
		<script>
			var urlParams = new URLSearchParams(window.location.search);
			var newsId = urlParams.get('newsId');
			$.ajax({
				url: 'http://localhost:8081/news/getNewsById/' + newsId,
				type: 'GET',
				dataType: 'json',
				success: function(newsData) {
					// 将新闻数据显示在页面上
					const newsContainer = $('#News-container');
					const newsItem = $('<div>');
					newsItem.html(`
					<div>
					<h2>${newsData.title}</h2>
					<img src="${newsData.imageUrl}">
					<p>${newsData.content}</p>
					<br>
					<p>日期:${newsData.createdAt}</p>
					<br>
					<br>
					<br>
					<hr>
					</div>
					`);
					newsContainer.append(newsItem);
				},
				error: function(error) {
					console.error('Error fetching news:', error);
				}
			});
			
			$.ajax({
				url: 'http://localhost:8081/Comment/getCommentByNewsId/' + newsId,
				type: 'GET',
				dataType: 'json',
				success: function(newsData) {
					// 将新闻数据显示在页面上
					const newsContainer = $('#Comment-container');
					newsContainer.empty();
					newsData.forEach(news => {
						const newsItem = $('<div>');
						newsItem.html(`
						<div>
						<h3 style="color: red;">评论:</h3>
						<div>${news.content}</div>
						<p>日期:${news.createdAt}</p>
						<br>
						<hr>
						</div>
						`);
						newsContainer.append(newsItem);
					});
				},
				error: function(error) {
					console.error('Error fetching news:', error);
				}
			});
			
			
			var userData = sessionStorage.getItem('user');
			// 解析JSON字符串为对象
			var userObject = JSON.parse(userData);
			// 获取特定字段的值，例如获取username的值
			function submitForm() {
				// 获取表单数据
				var formDataArray = $("#myForm").serializeArray();
				formDataArray.push({ name: "username", value: userObject.username },{ name: "newsId", value: newsId});
				// 将数组转回字符串
				var formData = $.param(formDataArray);
				// 发起Ajax请求
				$.ajax({
					type: "GET",
					url: "http://localhost:8081/Comment/insertComment", // 替换为实际的服务器端处理脚本地址
					data: formData,
					success: function(response) {
						if (response === "true")
							alert("提交成功");
					},
					error: function(error) {
						alert("异常")
					}
				});
			}
			
			
			
			
		</script>
	<body>
		
		<div id="News-container"></div>
		<div id="Comment-container"></div>
		<form id="myForm">
			<textarea style="height: 600px; width: 900px;" name="text"></textarea>
			<input type="button" value="提交" onclick="submitForm()">
		</form>
	</body>
	<script>
	</script>
</html>